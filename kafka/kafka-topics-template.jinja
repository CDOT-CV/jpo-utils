#------------------------------------------------------------
# jpo-ode topics
#------------------------------------------------------------
{% for topicName in values.topicNames %}
---
apiVersion: "kafka.jikkou.io/v1beta2"
kind: KafkaTopic
metadata:
  name: "{{ topicName }}"
  labels: 
    app: jpo-ode
spec:
  partitions: {{ system.env.KAFKA_TOPIC_PARTITIONS | default(values.defaultPartitions) }}
  replicas: {{ system.env.KAFKA_TOPIC_REPLICAS | default(values.defaultReplicas) }}
  configMapRefs: 
    - StreamTopic
{% endfor %}

#-----------------------------------------------------------------
# jpo-conflictmonitor topics
#-----------------------------------------------------------------
---
apiVersion: "kafka.jikkou.io/v1beta2"
kind: KafkaTopic
metadata:
  name: topic.CompactTopicTest
  labels: 
    app: jpo-conflictmonitor
spec:
  partitions: 1
  replicas: 1
  configMapRefs:
    - CompactTopic



#------------------------------------------------------------------
# Config Maps
#------------------------------------------------------------------

---
apiVersion: "core.jikkou.io/v1beta2"
kind: ConfigMap
metadata:
  name: StreamTopic
data:
  cleanup.policy: 'delete'
  min.insync.replicas: 1
  retention.ms: 3600000 # (3600000 = 1 hour)

---
apiVersion: "core.jikkou.io/v1beta2"
kind: ConfigMap
metadata:
  name: CompactTopic
data:
  cleanup.policy: 'compact'
  min.insync.replicas: 1



